{"ast":null,"code":"import _toConsumableArray from\"/Users/acaclasswork/Documents/PM01/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/acaclasswork/Documents/PM01/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/acaclasswork/Documents/PM01/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/acaclasswork/Documents/PM01/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import axios from\"axios\";import{Container,Button,Table}from\"react-bootstrap\";import SetRolesModal from\"../components/SetRolesModal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Projects(_ref){var currentUser=_ref.currentUser,localStorageCurrentUser=_ref.localStorageCurrentUser;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),projects=_useState2[0],setProjects=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),permissions=_useState4[0],setPermissions=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),counter=_useState6[0],setCounter=_useState6[1];var _useState7=useState({id:counter,title:\"\",description:\"\"}),_useState8=_slicedToArray(_useState7,2),input=_useState8[0],setInput=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isMod=_useState10[0],setIsMod=_useState10[1];React.useEffect(function(){// if someone is logged in, this will check to see if they are a moderator and store it in a useState hook (line 15) as a boolean\nlocalStorageCurrentUser&&axios.get(\"http://localhost:4001/users\").then(function(response){setIsMod(response.data.find(function(x){return x.username===localStorageCurrentUser;}).isModerator===0?false:true);console.log(\"isMod\",isMod);});// fetch permissions table from API and store in hook\naxios.get(\"http://localhost:4001/permissions\").then(function(response){setPermissions(response.data);});// fetch projects table from API and store in hook\naxios.get(\"http://localhost:4001/projects/\").then(function(response){setProjects(response.data);});},[]);// controls all the input fields in the add project form\nvar onChange=function onChange(event){setInput(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},event.target.name,event.target.value));});};// creates new project and stores it in hook and also the API\nvar onSubmit=function onSubmit(event){event.preventDefault();var project={id:counter,title:input.title,description:input.description};setProjects([].concat(_toConsumableArray(projects),[project]));setCounter(counter+1);setInput({title:\"\",description:\"\"});axios.post(\"http://localhost:4001/projects\",project).then(function(response){console.log(\"post project response\",response);}).catch(function(error){console.log(\"post project error\",error);});};// unfinished code to remove project\nvar removeProject=function removeProject(idx){var id=projects[idx].id;console.log(\"delete project: \",id);axios.delete(\"http://localhost:4001/projects/\".concat(id));// .then(response => response.json())\n// .then(data => console.log('deleted project: ', data.id));\n};return/*#__PURE__*/_jsxs(_Fragment,{children:[isMod&&/*#__PURE__*/_jsx(Container,{className:\"d-flex p-6 justify-content-center\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",style:{flex:\"10\",padding:\"5px\"},placeholder:\"Title ...\",value:input.title,onChange:onChange}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"description\",style:{flex:\"10\",padding:\"5px\"},placeholder:\"Description ...\",value:input.description,onChange:onChange}),/*#__PURE__*/_jsx(Button,{type:\"submit\",value:\"Submit\",className:\"btn\",style:{flex:\"1\"},children:\"Add Project\"}),/*#__PURE__*/_jsx(Container,{className:\"d-flex p-6 justify-content-center\",children:isMod&&/*#__PURE__*/_jsx(SetRolesModal,{projects:projects})})]})}),/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,variant:\"dark\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID#\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Project Title\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Project Description\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:permissions.map(function(permission,idx){return projects.filter(function(x){return x.id===permission.project_id&&permission.username===localStorageCurrentUser;}).map(function(project,idx){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:project.id}),/*#__PURE__*/_jsx(\"td\",{children:project.title}),/*#__PURE__*/_jsx(\"td\",{children:project.description})]});});})})]})})]});}export default Projects;","map":{"version":3,"sources":["/Users/acaclasswork/Documents/PM01/react/src/components/Projects.js"],"names":["React","useState","axios","Container","Button","Table","SetRolesModal","Projects","currentUser","localStorageCurrentUser","projects","setProjects","permissions","setPermissions","counter","setCounter","id","title","description","input","setInput","isMod","setIsMod","useEffect","get","then","response","data","find","x","username","isModerator","console","log","onChange","event","prevState","target","name","value","onSubmit","preventDefault","project","post","catch","error","removeProject","idx","delete","flex","padding","map","permission","filter","project_id"],"mappings":"qoBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,CAAoBC,MAApB,CAA4BC,KAA5B,KAAyC,iBAAzC,CACA,MAAOC,CAAAA,aAAP,KAA0B,6BAA1B,C,6IAEA,QAASC,CAAAA,QAAT,MAA4D,IAAxCC,CAAAA,WAAwC,MAAxCA,WAAwC,CAA3BC,uBAA2B,MAA3BA,uBAA2B,eAC1BR,QAAQ,CAAC,EAAD,CADkB,wCACnDS,QADmD,eACzCC,WADyC,8BAEpBV,QAAQ,CAAC,EAAD,CAFY,yCAEnDW,WAFmD,eAEtCC,cAFsC,8BAG5BZ,QAAQ,CAAC,CAAD,CAHoB,yCAGnDa,OAHmD,eAG1CC,UAH0C,8BAIhCd,QAAQ,CAAC,CACjCe,EAAE,CAAEF,OAD6B,CAEjCG,KAAK,CAAE,EAF0B,CAGjCC,WAAW,CAAE,EAHoB,CAAD,CAJwB,yCAInDC,KAJmD,eAI5CC,QAJ4C,8BAShCnB,QAAQ,CAAC,KAAD,CATwB,0CASnDoB,KATmD,gBAS5CC,QAT4C,gBAW1DtB,KAAK,CAACuB,SAAN,CAAgB,UAAM,CACpB;AACAd,uBAAuB,EACrBP,KAAK,CAACsB,GAAN,CAAU,6BAAV,EAAyCC,IAAzC,CAA8C,SAACC,QAAD,CAAc,CAC1DJ,QAAQ,CACNI,QAAQ,CAACC,IAAT,CAAcC,IAAd,CAAmB,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACC,QAAF,GAAerB,uBAAtB,EAAnB,EACGsB,WADH,GACmB,CADnB,CAEI,KAFJ,CAGI,IAJE,CAAR,CAMAC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBZ,KAArB,EACD,CARD,CADF,CAUA;AACAnB,KAAK,CAACsB,GAAN,CAAU,mCAAV,EAA+CC,IAA/C,CAAoD,SAACC,QAAD,CAAc,CAChEb,cAAc,CAACa,QAAQ,CAACC,IAAV,CAAd,CACD,CAFD,EAGA;AACAzB,KAAK,CAACsB,GAAN,CAAU,iCAAV,EAA6CC,IAA7C,CAAkD,SAACC,QAAD,CAAc,CAC9Df,WAAW,CAACe,QAAQ,CAACC,IAAV,CAAX,CACD,CAFD,EAGD,CApBD,CAoBG,EApBH,EAsBA;AACA,GAAMO,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,KAAD,CAAW,CAC1Bf,QAAQ,CAAC,SAACgB,SAAD,wCACJA,SADI,wBAEND,KAAK,CAACE,MAAN,CAAaC,IAFP,CAEcH,KAAK,CAACE,MAAN,CAAaE,KAF3B,IAAD,CAAR,CAID,CALD,CAOA;AACA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACL,KAAD,CAAW,CAC1BA,KAAK,CAACM,cAAN,GACA,GAAIC,CAAAA,OAAO,CAAG,CACZ1B,EAAE,CAAEF,OADQ,CAEZG,KAAK,CAAEE,KAAK,CAACF,KAFD,CAGZC,WAAW,CAAEC,KAAK,CAACD,WAHP,CAAd,CAKAP,WAAW,8BAAKD,QAAL,GAAegC,OAAf,GAAX,CACA3B,UAAU,CAACD,OAAO,CAAG,CAAX,CAAV,CACAM,QAAQ,CAAC,CACPH,KAAK,CAAE,EADA,CAEPC,WAAW,CAAE,EAFN,CAAD,CAAR,CAIAhB,KAAK,CACFyC,IADH,kCAC0CD,OAD1C,EAEGjB,IAFH,CAEQ,SAAUC,QAAV,CAAoB,CACxBM,OAAO,CAACC,GAAR,CAAY,uBAAZ,CAAqCP,QAArC,EACD,CAJH,EAKGkB,KALH,CAKS,SAAUC,KAAV,CAAiB,CACtBb,OAAO,CAACC,GAAR,CAAY,oBAAZ,CAAkCY,KAAlC,EACD,CAPH,EAQD,CArBD,CAuBA;AACA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,GAAD,CAAS,CAC7B,GAAI/B,CAAAA,EAAE,CAAGN,QAAQ,CAACqC,GAAD,CAAR,CAAc/B,EAAvB,CACAgB,OAAO,CAACC,GAAR,CAAY,kBAAZ,CAAgCjB,EAAhC,EACAd,KAAK,CAAC8C,MAAN,0CAA+ChC,EAA/C,GACA;AACA;AACD,CAND,CAQA,mBACE,2BAEGK,KAAK,eACJ,KAAC,SAAD,EAAW,SAAS,CAAC,mCAArB,uBACE,cAAM,QAAQ,CAAEmB,QAAhB,wBACE,cACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,OAFP,CAGE,KAAK,CAAE,CAAES,IAAI,CAAE,IAAR,CAAcC,OAAO,CAAE,KAAvB,CAHT,CAIE,WAAW,CAAC,WAJd,CAKE,KAAK,CAAE/B,KAAK,CAACF,KALf,CAME,QAAQ,CAAEiB,QANZ,EADF,cASE,cACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,aAFP,CAGE,KAAK,CAAE,CAAEe,IAAI,CAAE,IAAR,CAAcC,OAAO,CAAE,KAAvB,CAHT,CAIE,WAAW,CAAC,iBAJd,CAKE,KAAK,CAAE/B,KAAK,CAACD,WALf,CAME,QAAQ,CAAEgB,QANZ,EATF,cAiBE,KAAC,MAAD,EACE,IAAI,CAAC,QADP,CAEE,KAAK,CAAC,QAFR,CAGE,SAAS,CAAC,KAHZ,CAIE,KAAK,CAAE,CAAEe,IAAI,CAAE,GAAR,CAJT,yBAjBF,cAyBE,KAAC,SAAD,EAAW,SAAS,CAAC,mCAArB,UACG5B,KAAK,eAAI,KAAC,aAAD,EAAe,QAAQ,CAAEX,QAAzB,EADZ,EAzBF,GADF,EAHJ,cAoCE,KAAC,SAAD,wBACE,MAAC,KAAD,EAAO,OAAO,KAAd,CAAe,QAAQ,KAAvB,CAAwB,KAAK,KAA7B,CAA8B,OAAO,CAAC,MAAtC,wBACE,oCACE,mCACE,2BADF,cAEE,qCAFF,cAGE,2CAHF,GADF,EADF,cAQE,uBAEGE,WAAW,CAACuC,GAAZ,CAAgB,SAACC,UAAD,CAAaL,GAAb,QACfrC,CAAAA,QAAQ,CACL2C,MADH,CAEI,SAACxB,CAAD,QACEA,CAAAA,CAAC,CAACb,EAAF,GAASoC,UAAU,CAACE,UAApB,EACAF,UAAU,CAACtB,QAAX,GAAwBrB,uBAF1B,EAFJ,EAMG0C,GANH,CAMO,SAACT,OAAD,CAAUK,GAAV,qBACH,mCACE,oBAAKL,OAAO,CAAC1B,EAAb,EADF,cAEE,oBAAK0B,OAAO,CAACzB,KAAb,EAFF,cAGE,oBAAKyB,OAAO,CAACxB,WAAb,EAHF,GADG,EANP,CADe,EAAhB,CAFH,EARF,GADF,EApCF,GADF,CAoED,CAED,cAAeX,CAAAA,QAAf","sourcesContent":["import React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { Container, Button, Table } from \"react-bootstrap\";\nimport SetRolesModal from \"../components/SetRolesModal\";\n\nfunction Projects({ currentUser, localStorageCurrentUser }) {\n  const [projects, setProjects] = useState([]);\n  const [permissions, setPermissions] = useState([]);\n  const [counter, setCounter] = useState(1);\n  const [input, setInput] = useState({\n    id: counter,\n    title: \"\",\n    description: \"\",\n  });\n  const [isMod, setIsMod] = useState(false);\n\n  React.useEffect(() => {\n    // if someone is logged in, this will check to see if they are a moderator and store it in a useState hook (line 15) as a boolean\n    localStorageCurrentUser &&\n      axios.get(\"http://localhost:4001/users\").then((response) => {\n        setIsMod(\n          response.data.find((x) => x.username === localStorageCurrentUser)\n            .isModerator === 0\n            ? false\n            : true\n        );\n        console.log(\"isMod\", isMod);\n      });\n    // fetch permissions table from API and store in hook\n    axios.get(\"http://localhost:4001/permissions\").then((response) => {\n      setPermissions(response.data);\n    });\n    // fetch projects table from API and store in hook\n    axios.get(\"http://localhost:4001/projects/\").then((response) => {\n      setProjects(response.data);\n    });\n  }, []);\n\n  // controls all the input fields in the add project form\n  const onChange = (event) => {\n    setInput((prevState) => ({\n      ...prevState,\n      [event.target.name]: event.target.value,\n    }));\n  };\n\n  // creates new project and stores it in hook and also the API\n  const onSubmit = (event) => {\n    event.preventDefault();\n    let project = {\n      id: counter,\n      title: input.title,\n      description: input.description,\n    };\n    setProjects([...projects, project]);\n    setCounter(counter + 1);\n    setInput({\n      title: \"\",\n      description: \"\",\n    });\n    axios\n      .post(`http://localhost:4001/projects`, project)\n      .then(function (response) {\n        console.log(\"post project response\", response);\n      })\n      .catch(function (error) {\n        console.log(\"post project error\", error);\n      });\n  };\n\n  // unfinished code to remove project\n  const removeProject = (idx) => {\n    let id = projects[idx].id;\n    console.log(\"delete project: \", id);\n    axios.delete(`http://localhost:4001/projects/${id}`);\n    // .then(response => response.json())\n    // .then(data => console.log('deleted project: ', data.id));\n  };\n\n  return (\n    <>\n      {/* add project form begins below */}\n      {isMod && (\n        <Container className=\"d-flex p-6 justify-content-center\">\n          <form onSubmit={onSubmit}>\n            <input\n              type=\"text\"\n              name=\"title\"\n              style={{ flex: \"10\", padding: \"5px\" }}\n              placeholder=\"Title ...\"\n              value={input.title}\n              onChange={onChange}\n            />\n            <input\n              type=\"text\"\n              name=\"description\"\n              style={{ flex: \"10\", padding: \"5px\" }}\n              placeholder=\"Description ...\"\n              value={input.description}\n              onChange={onChange}\n            />\n            <Button\n              type=\"submit\"\n              value=\"Submit\"\n              className=\"btn\"\n              style={{ flex: \"1\" }}\n            >\n              Add Project\n            </Button>\n            <Container className=\"d-flex p-6 justify-content-center\">\n              {isMod && <SetRolesModal projects={projects} />}\n            </Container>\n          </form>\n        </Container>\n      )}\n      {/* form ends above and table begins below */}\n      <Container>\n        <Table striped bordered hover variant=\"dark\">\n          <thead>\n            <tr>\n              <th>ID#</th>\n              <th>Project Title</th>\n              <th>Project Description</th>\n            </tr>\n          </thead>\n          <tbody>\n            {/* (below) maps over permissions table to filter projects assigned to current user and render them in the table */}\n            {permissions.map((permission, idx) =>\n              projects\n                .filter(\n                  (x) =>\n                    x.id === permission.project_id &&\n                    permission.username === localStorageCurrentUser\n                )\n                .map((project, idx) => (\n                  <tr>\n                    <td>{project.id}</td>\n                    <td>{project.title}</td>\n                    <td>{project.description}</td>\n                  </tr>\n                ))\n            )}\n          </tbody>\n        </Table>\n      </Container>\n    </>\n  );\n}\n\nexport default Projects;\n"]},"metadata":{},"sourceType":"module"}