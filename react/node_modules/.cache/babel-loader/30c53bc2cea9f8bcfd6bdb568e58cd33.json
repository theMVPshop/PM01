{"ast":null,"code":"import _slicedToArray from\"/Users/acaclasswork/Documents/PM01/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import axios from\"axios\";import{Table,Container,Form,Button}from\"react-bootstrap\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SetRoles(_ref){var projects=_ref.projects;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),permissions=_useState4[0],setPermissions=_useState4[1];useEffect(function(){axios.get(\"http://localhost:4001/users/\").then(function(response){console.log(response.data);setUsers(response.data);});axios.get(\"http://localhost:4001/permissions/\").then(function(response){console.log(response.data);setPermissions(response.data);});},[]);var handleClick=function handleClick(isMod,username){axios.post(\"http://localhost:4001/users/\",{isModerator:!isMod,username:username}).then(function(){axios.get(\"http://localhost:4001/users/\").then(function(response){setUsers(response.data);});});};var handleChangePermission=function handleChangePermission(e,project_id,username,permissionObject){var permissionId=permissionObject&&permissionObject.id;e.target.checked?axios.post(\"http://localhost:4001/permissions/\",{username:username,project_id:project_id}).then(function(){axios.get(\"http://localhost:4001/permissions/\").then(function(response){setPermissions(response.data);});}):axios.delete(\"http://localhost:4001/permissions/\".concat(permissionId)).then(function(){axios.get(\"http://localhost:4001/permissions/\").then(function(response){setPermissions(response.data);});});};return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,variant:\"dark\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Permissions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(function(user,idx){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user.username}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:user.isModerator?\"success\":\"warning\",onClick:function onClick(){return handleClick(user.isModerator,user.username);},children:user.isModerator?\"Moderator\":\"Client\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Form,{children:[\"checkbox\"].map(function(type){return/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:projects.map(function(project,idx){var permissionObject=permissions.find(function(x){return x.username===user.username&&x.project_id===project.id;});return/*#__PURE__*/_jsx(Form.Check,{inline:true,label:project.title,type:type,id:\"inline-\".concat(type,\"-1\"),checked:permissionObject// value={}\n,onChange:function onChange(e){return handleChangePermission(e,project.id,user.username,permissionObject);}});})},\"inline-\".concat(type));})})})]});})})]})});}export default SetRoles;","map":{"version":3,"sources":["/Users/acaclasswork/Documents/PM01/react/src/components/SetRoles.js"],"names":["React","useEffect","useState","axios","Table","Container","Form","Button","SetRoles","projects","users","setUsers","permissions","setPermissions","get","then","response","console","log","data","handleClick","isMod","username","post","isModerator","handleChangePermission","e","project_id","permissionObject","permissionId","id","target","checked","delete","map","user","idx","type","project","find","x","title"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { Table, Container, Form, Button } from \"react-bootstrap\";\n\nfunction SetRoles({ projects }) {\n  const [users, setUsers] = useState([]);\n  const [permissions, setPermissions] = useState([]);\n\n  useEffect(() => {\n    axios.get(\"http://localhost:4001/users/\").then((response) => {\n      console.log(response.data);\n      setUsers(response.data);\n    });\n    axios.get(\"http://localhost:4001/permissions/\").then((response) => {\n      console.log(response.data);\n      setPermissions(response.data);\n    });\n  }, []);\n\n  const handleClick = (isMod, username) => {\n    axios\n      .post(\"http://localhost:4001/users/\", {\n        isModerator: !isMod,\n        username,\n      })\n      .then(() => {\n        axios.get(\"http://localhost:4001/users/\").then((response) => {\n          setUsers(response.data);\n        });\n      });\n  };\n\n  const handleChangePermission = (\n    e,\n    project_id,\n    username,\n    permissionObject\n  ) => {\n    let permissionId = permissionObject && permissionObject.id;\n    e.target.checked\n      ? axios\n          .post(\"http://localhost:4001/permissions/\", {\n            username,\n            project_id,\n          })\n          .then(() => {\n            axios.get(\"http://localhost:4001/permissions/\").then((response) => {\n              setPermissions(response.data);\n            });\n          })\n      : axios\n          .delete(`http://localhost:4001/permissions/${permissionId}`)\n          .then(() => {\n            axios.get(\"http://localhost:4001/permissions/\").then((response) => {\n              setPermissions(response.data);\n            });\n          });\n  };\n\n  return (\n    <Container>\n      <Table striped bordered hover variant=\"dark\">\n        <thead>\n          <tr>\n            <th>Username</th>\n            <th>Role</th>\n            <th>Permissions</th>\n          </tr>\n        </thead>\n        <tbody>\n          {users.map((user, idx) => (\n            <tr>\n              <td>{user.username}</td>\n              <td>\n                <Button\n                  variant={user.isModerator ? \"success\" : \"warning\"}\n                  onClick={() => handleClick(user.isModerator, user.username)}\n                >\n                  {user.isModerator ? \"Moderator\" : \"Client\"}\n                </Button>\n              </td>\n              <td>\n                <Form>\n                  {[\"checkbox\"].map((type) => (\n                    <div key={`inline-${type}`} className=\"mb-3\">\n                      {projects.map((project, idx) => {\n                        let permissionObject = permissions.find(\n                          (x) =>\n                            x.username === user.username &&\n                            x.project_id === project.id\n                        );\n\n                        return (\n                          <Form.Check\n                            inline\n                            label={project.title}\n                            type={type}\n                            id={`inline-${type}-1`}\n                            checked={permissionObject}\n                            // value={}\n                            onChange={(e) =>\n                              handleChangePermission(\n                                e,\n                                project.id,\n                                user.username,\n                                permissionObject\n                              )\n                            }\n                          />\n                        );\n                      })}\n                    </div>\n                  ))}\n                </Form>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </Table>\n    </Container>\n  );\n}\n\nexport default SetRoles;\n"]},"metadata":{},"sourceType":"module"}