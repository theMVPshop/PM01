{"ast":null,"code":"import _slicedToArray from\"/Users/acaclasswork/Documents/PM01/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import Navigation from\"./components/Navigation\";import ReactRouter from\"./ReactRouter\";import axios from\"axios\";import{withRouter}from\"react-router\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var netlifyIdentity=require(\"netlify-identity-widget\");var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),currentUser=_React$useState2[0],setCurrentUser=_React$useState2[1];netlifyIdentity.init();var user=netlifyIdentity.currentUser();console.log(user);function initNetlifyIdentity(){var script=document.createElement(\"script\");script.src=\"https://identity.netlify.com/v1/netlify-identity-widget.js\";script.async=true;document.body.appendChild(script);}function openNetlifyModal(){var netlifyIdentity=window.netlifyIdentity;if(netlifyIdentity){netlifyIdentity.open();netlifyIdentity.on(\"login\",function(user){console.log(\"login\",user);axios.get(\"http://localhost:4001/users\").then(function(response){var existingUser=response.data.find(function(x){return x.username===user.email;});!existingUser&&axios.post(\"http://localhost:4001/users/\",{username:user.email,isModerator:0});setCurrentUser(user.email);});});}else{console.log(\"netlifyIdentity not defined\");}}function NetlifyIdentity(){React.useEffect(function(){initNetlifyIdentity();},[]);return/*#__PURE__*/_jsx(_Fragment,{});}var NavWithRouter=withRouter(Navigation);var localStorageCurrentUser=currentUser&&JSON.parse(localStorage.getItem(\"gotrue.user\")).email;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavWithRouter,{NetlifyIdentity:NetlifyIdentity,openNetlifyModal:openNetlifyModal}),/*#__PURE__*/_jsx(ReactRouter,{currentUser:currentUser,localStorageCurrentUser:localStorageCurrentUser}),/*#__PURE__*/_jsxs(\"p\",{children:[\"currentUser: \",currentUser&&\"welcome \".concat(currentUser)]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"localStorage currentUser: \",\"welcome \".concat(localStorageCurrentUser)]})]});}export default App;","map":{"version":3,"sources":["/Users/acaclasswork/Documents/PM01/react/src/App.js"],"names":["React","Navigation","ReactRouter","axios","withRouter","App","netlifyIdentity","require","useState","currentUser","setCurrentUser","init","user","console","log","initNetlifyIdentity","script","document","createElement","src","async","body","appendChild","openNetlifyModal","window","open","on","get","then","response","existingUser","data","find","x","username","email","post","isModerator","NetlifyIdentity","useEffect","NavWithRouter","localStorageCurrentUser","JSON","parse","localStorage","getItem"],"mappings":"+JAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,UAAP,KAAuB,yBAAvB,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,KAA2B,cAA3B,C,6IAEA,QAASC,CAAAA,GAAT,EAAe,CACb,GAAMC,CAAAA,eAAe,CAAGC,OAAO,CAAC,yBAAD,CAA/B,CADa,oBAEyBP,KAAK,CAACQ,QAAN,CAAe,IAAf,CAFzB,oDAENC,WAFM,qBAEOC,cAFP,qBAIbJ,eAAe,CAACK,IAAhB,GAEA,GAAMC,CAAAA,IAAI,CAAGN,eAAe,CAACG,WAAhB,EAAb,CAEAI,OAAO,CAACC,GAAR,CAAYF,IAAZ,EAEA,QAASG,CAAAA,mBAAT,EAA+B,CAC7B,GAAMC,CAAAA,MAAM,CAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf,CAEAF,MAAM,CAACG,GAAP,CAAa,4DAAb,CACAH,MAAM,CAACI,KAAP,CAAe,IAAf,CAEAH,QAAQ,CAACI,IAAT,CAAcC,WAAd,CAA0BN,MAA1B,EACD,CAED,QAASO,CAAAA,gBAAT,EAA4B,CAC1B,GAAMjB,CAAAA,eAAe,CAAGkB,MAAM,CAAClB,eAA/B,CAEA,GAAIA,eAAJ,CAAqB,CACnBA,eAAe,CAACmB,IAAhB,GACAnB,eAAe,CAACoB,EAAhB,CAAmB,OAAnB,CAA4B,SAACd,IAAD,CAAU,CACpCC,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,IAArB,EACAT,KAAK,CAACwB,GAAN,CAAU,6BAAV,EAAyCC,IAAzC,CAA8C,SAACC,QAAD,CAAc,CAC1D,GAAIC,CAAAA,YAAY,CAAGD,QAAQ,CAACE,IAAT,CAAcC,IAAd,CACjB,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACC,QAAF,GAAetB,IAAI,CAACuB,KAA3B,EADiB,CAAnB,CAGA,CAACL,YAAD,EACE3B,KAAK,CAACiC,IAAN,CAAW,8BAAX,CAA2C,CACzCF,QAAQ,CAAEtB,IAAI,CAACuB,KAD0B,CAEzCE,WAAW,CAAE,CAF4B,CAA3C,CADF,CAKA3B,cAAc,CAACE,IAAI,CAACuB,KAAN,CAAd,CACD,CAVD,EAWD,CAbD,EAcD,CAhBD,IAgBO,CACLtB,OAAO,CAACC,GAAR,CAAY,6BAAZ,EACD,CACF,CAED,QAASwB,CAAAA,eAAT,EAA2B,CACzBtC,KAAK,CAACuC,SAAN,CAAgB,UAAM,CACpBxB,mBAAmB,GACpB,CAFD,CAEG,EAFH,EAIA,mBAAO,kBAAP,CACD,CAED,GAAMyB,CAAAA,aAAa,CAAGpC,UAAU,CAACH,UAAD,CAAhC,CACA,GAAIwC,CAAAA,uBAAuB,CACzBhC,WAAW,EAAIiC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAX,EAAgDV,KADjE,CAGA,mBACE,wCACE,KAAC,aAAD,EACE,eAAe,CAAEG,eADnB,CAEE,gBAAgB,CAAEf,gBAFpB,EADF,cAKE,KAAC,WAAD,EACE,WAAW,CAAEd,WADf,CAEE,uBAAuB,CAAEgC,uBAF3B,EALF,cASE,qCAAiBhC,WAAW,oBAAeA,WAAf,CAA5B,GATF,cAUE,oEAAyCgC,uBAAzC,IAVF,GADF,CAcD,CAED,cAAepC,CAAAA,GAAf","sourcesContent":["import React from \"react\";\nimport Navigation from \"./components/Navigation\";\nimport ReactRouter from \"./ReactRouter\";\nimport axios from \"axios\";\nimport { withRouter } from \"react-router\";\n\nfunction App() {\n  const netlifyIdentity = require(\"netlify-identity-widget\");\n  const [currentUser, setCurrentUser] = React.useState(null);\n\n  netlifyIdentity.init();\n\n  const user = netlifyIdentity.currentUser();\n\n  console.log(user);\n\n  function initNetlifyIdentity() {\n    const script = document.createElement(\"script\");\n\n    script.src = \"https://identity.netlify.com/v1/netlify-identity-widget.js\";\n    script.async = true;\n\n    document.body.appendChild(script);\n  }\n\n  function openNetlifyModal() {\n    const netlifyIdentity = window.netlifyIdentity;\n\n    if (netlifyIdentity) {\n      netlifyIdentity.open();\n      netlifyIdentity.on(\"login\", (user) => {\n        console.log(\"login\", user);\n        axios.get(\"http://localhost:4001/users\").then((response) => {\n          let existingUser = response.data.find(\n            (x) => x.username === user.email\n          );\n          !existingUser &&\n            axios.post(\"http://localhost:4001/users/\", {\n              username: user.email,\n              isModerator: 0,\n            });\n          setCurrentUser(user.email);\n        });\n      });\n    } else {\n      console.log(\"netlifyIdentity not defined\");\n    }\n  }\n\n  function NetlifyIdentity() {\n    React.useEffect(() => {\n      initNetlifyIdentity();\n    }, []);\n\n    return <></>;\n  }\n\n  const NavWithRouter = withRouter(Navigation);\n  let localStorageCurrentUser =\n    currentUser && JSON.parse(localStorage.getItem(\"gotrue.user\")).email;\n\n  return (\n    <>\n      <NavWithRouter\n        NetlifyIdentity={NetlifyIdentity}\n        openNetlifyModal={openNetlifyModal}\n      />\n      <ReactRouter\n        currentUser={currentUser}\n        localStorageCurrentUser={localStorageCurrentUser}\n      />\n      <p>currentUser: {currentUser && `welcome ${currentUser}`}</p>\n      <p>localStorage currentUser: {`welcome ${localStorageCurrentUser}`}</p>\n    </>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}